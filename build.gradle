group 'com.jkmvc'
version '1.0-SNAPSHOT'

//gradle脚本自身需要使用的资源
buildscript {
    repositories {
        jcenter()
        mavenCentral()
        maven {
            url 'http://maven.aliyun.com/nexus/content/repositories/snapshots'
        }
        maven {
            url "http://dl.bintray.com/kotlin/kotlin"
        }
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }
}

/*repositories {
    mavenCentral()
    maven {
        url 'http://maven.aliyun.com/nexus/content/repositories/snapshots'
    }
    maven {
        url "http://dl.bintray.com/kotlin/kotlin"
    }
}*/

apply plugin: 'maven'
apply plugin: 'java'
apply plugin: 'kotlin'
apply plugin: 'war'
apply plugin: 'jetty'

sourceCompatibility = 1.5

repositories {
    mavenCentral()
}

dependencies {
    compile "org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version"
    compile "org.jetbrains.kotlin:kotlin-reflect:$kotlin_version"
	// log
    compile 'org.slf4j:slf4j-api:1.7.12'
    compile 'log4j:log4j:1.2.17'
	// db
    compile 'com.alibaba:druid:1.0.25'
    // upload
    compile 'servlets.com:cos:05Nov2002'
    // velocity
    compile 'org.apache.velocity:velocity:1.7'

    // servlet
    providedCompile "javax.servlet:javax.servlet-api:3.1.0"
    providedCompile "javax.servlet.jsp:jsp-api:2.2.1-b03"
    providedCompile "javax.servlet.jsp.jstl:javax.servlet.jsp.jstl-api:1.2.1"

    // test
    testCompile "org.jetbrains.kotlin:kotlin-test-junit:$kotlin_version"
    testCompile 'junit:junit:4.11'

    // server
//    testCompile "org.eclipse.jetty.aggregate:jetty-all:$jetty_version"
    testCompile "org.eclipse.jetty:jetty-webapp:$jetty_version"
    testRuntime "org.eclipse.jetty:jetty-jsp:$jetty_version"
    testRuntime "org.eclipse.jetty:jetty-servlet:$jetty_version"

    // db
    providedRuntime "mysql:mysql-connector-java:5.1.6"
//    providedRuntime 'com.h2database:h2:1.4.186'
//    providedRuntime 'org.postgresql:postgresql:9.4.1208.jre7'
//    providedRuntime 'ru.yandex.qatools.embed:postgresql-embedded:1.13'
}

/*sourceSets {
    main {
        java {
            srcDirs = ['src/main/java', 'src/main/kotlin']
        }
        resources {
            srcDirs = ['src/main/resources']
        }
    }
    test {
        java {
            srcDirs = ['src/test/java', 'src/test/kotlin']
        }
        resources {
            srcDirs = ['src/test/resources']
        }
    }
}*/

jettyRun{
    webAppSourceDirectory file("$projectDir/src/main/webapp")
    httpPort 8082
    contextPath project.name
    scanIntervalSeconds 1 // jetty 热部署，当值为0时，不扫描新class，不热部署
    reload "automatic"
}
